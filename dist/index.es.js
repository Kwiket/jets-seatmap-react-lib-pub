import e,{useContext as t,useRef as s,useState as a,useEffect as r}from"react";function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},i.apply(this,arguments)}class o{constructor(){l(this,"getData",(async(e,t={})=>{const s=await fetch(`${this._apiUrl}/${e}`,t);if(!s.ok)throw new Error(`Error: ${s.error}`);return await s.json()})),l(this,"postData",(async(e,t,s={})=>{const a={...s,method:"post",body:JSON.stringify(t)},r=`${this._apiUrl}/${e}`;return(await fetch(r,a)).json()})),l(this,"getRequestOptions",(e=>({headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}))),this._apiUrl="https://sandbox.quicket.io/api/v1"}}class n{getData(e){try{const t=localStorage.getItem(e);if(!t)return null;const{value:s,expiry:a}=JSON.parse(t),r=(new Date).getTime();return!s||a<r?(this.removeData(e),null):s}catch(e){return console.log("Error getting data from local storage. Message:",e),null}}setData(e,t,s){try{const a={value:t};return s&&(a.expiry=(new Date).getTime()+s),localStorage.setItem(e,JSON.stringify(a)),!0}catch(e){return console.log("Error saving data to local storage. Message:",e),!1}}removeData(e){localStorage.removeItem(e)}clearStorage(){localStorage.clear()}}const c={headers:{Authorization:"Bearer d5c55bd9-60f0-4e2f-84e0-seatmaps-com"}};class d{constructor(){l(this,"getToken",(async()=>{const e=this._localStorage.getData("jetsJwtToken");if(e)return e;const{accessToken:t}=await this._api.getData("auth?appId=aff6eb5e-1c83-4e5c-a2a2-seatmaps-com",c);if(!t)throw Error;return this._saveToken(t),t})),l(this,"_saveToken",(e=>{if(!e)return;const{exp:t}=this._parseJwt(e),s=this._getTokenTTL(t);this._localStorage.setData("jetsJwtToken",e,s)})),this._localStorage=new n,this._api=new o}_getTokenTTL(e){return 1e3*e-Date.now()-3e5}_parseJwt(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(s)}}class h{static generateId(){return"_"+Math.random().toString(36).substring(2,9)}}const p={available:"available",unavailable:"unavailable",selected:"selected",preferred:"preferred",extra:"extra",disabled:"disabled"},g={seat:"seat",aisle:"aisle",empty:"empty",index:"index"},f={seat:"S",empty:"E",aisle:"-"},m={f:"First",b:"Business",p:"Premium economy",e:"Economy"},u={EN:{restrictedLegroom:"Constrained Legroom",extraLegroom:"Extra Legroom",noFloorStorage:"No underseat storage",noOverheadStorage:"Limited storage space",limitedOverheadStorage:"Limited storage space",trayTableInArmrest:"Tray table in the armrest",getColdByExit:"Close to exit, drafts and chilly",misalignedWindow:"Partial or missing window view",noWindow:"Partial or missing window view",doNotRecline:"Restricted recline, backaches possible",limitedRecline:"Restricted recline, backaches possible",storageBoxBetweenWall:"Storage box between wall",nearLavatory:"Close to restrooms",nearGalley:"Close to galleys",nearStairs:"Stairs, heavy traffic area",wingInWindow:"Wing from window view",standardSeat:"Standard seat",reservedCrewSeat:"Reserved",bassinet:"Baby bassinet available",babyBassinet:"Baby bassinet available",audio_video_ondemand:"Audio & Video On Demand",audioVideo:"Audio & Video On Demand",wifi_enabled:"WiFi enabled",wifiEnabled:"WiFi enabled",usbPlug:"USB plug",usbPowerPlug:"USB & power plug",powerPlug:"Power plug",power:"Power plug",pitch:"Pitch",recline:"Recline",width:"Width",cancel:"Cancel",select:"Select",unselect:"Unselect",deck:"Deck"},RU:{restrictedLegroom:"Мало места для ног",extraLegroom:"Много места для ног",noFloorStorage:"Нет места для ручной клади под сиденьем",noOverheadStorage:"Нет полки для ручной клади",limitedOverheadStorage:"Полка ручной клади ограничена в размерах",trayTableInArmrest:"Откидной столик в подлокотнике",getColdByExit:"Возле выхода",misalignedWindow:"Иллюминатор смещён",noWindow:"Иллюминатор отстутсвует",doNotRecline:"Спинка кресла не отклоняется",limitedRecline:"Ограниченное отклонение спинки кресла",storageBoxBetweenWall:"Ящик для хранения в стене",nearLavatory:"Около туалета",nearGalley:"Около буфета-кухни",nearStairs:"Рядом с лестницей, активное движение",wingInWindow:"Место возле крыла самолёта",standardSeat:"Стандартное сиденье",reservedCrewSeat:"Зарезервированное персоналом",bassinet:"Рядом с детской кроваткий",babyBassinet:"Рядом с детской кроваткой",audio_video_ondemand:"Развлекательная аудио- и видеопрограмма",audioVideo:"Развлекательная аудио- и видеопрограмма",wifi_enabled:"Наличие WiFi",wifiEnabled:"Наличие WiFi",usbPlug:"Наличие USB-порта",usbPowerPlug:"Наличие розетки и USB-порта",powerPlug:"Розетка",power:"Розетка",pitch:"Длинна",width:"Ширина",recline:"Наклон",cancel:"Закрыть",select:"Выбрать",unselect:"Убрать",deck:"Этаж"},CN:{restrictedLegroom:"腿部空间较小",extraLegroom:"腿部空间较大",noFloorStorage:"前面无座位",noOverheadStorage:"行李柜较小",limitedOverheadStorage:"行李柜较小",trayTableInArmrest:"托盘桌在扶手里",getColdByExit:"靠近紧急出口，较冷",misalignedWindow:"部分窗户或无窗户",noWindow:"部分窗户或无窗户",doNotRecline:"后仰角度小，可能背疼",limitedRecline:"后仰角度小，可能背疼",storageBoxBetweenWall:"牆間儲物箱",nearLavatory:"靠近洗手间",nearGalley:"靠近厨房",nearStairs:"楼梯，来往人流较多",wingInWindow:"机翼在窗外视线内",standardSeat:"标准座位",reservedCrewSeat:"已预订",bassinet:"有婴儿摇篮",babyBassinet:"有婴儿摇篮",audio_video_ondemand:"自选式机上视听娱乐系统",audioVideo:"自选式机上视听娱乐系统",wifi_enabled:"有WiFi",wifiEnabled:"有WiFi",usbPlug:"USB端口",usbPowerPlug:"USB端口及电源插座",powerPlug:"电源插座",power:"电源插座",pitch:"座位间距",width:"座位宽度",recline:"倾斜度",cancel:"取消",select:"選擇",unselect:"取消選擇",deck:"甲板"}},w=["seatDetails","cabin","seatMapLink"],b={F:{width:124,height:200},B:{width:124,height:200},P:{width:86,height:100},E:{width:86,height:100}},v={width:86,height:100},k="rgb(237, 237, 237)",y=e.createContext(),x={getTemplateBySeatType(e,t){if(!e)return;const[s,a]=e.split("-");return"B"===s?C.getTemplate(a,t):"F"===s?$.getTemplate(a,t):"P"===s?_.getTemplate(a,t):"E"===s?S.getTemplate(a,t):this._getFallBackTemplate()},_getFallBackTemplate:()=>S.getTemplate(type,style)},C={getTemplate(e,t){return"1"===e?this._type1(t):"4"===e?this._type4(t):this._default(t)},_type1:e=>`<svg version="1.1" baseProfile="full" viewBox="0 0 150 150" xmlns="http://www.w3.org/2000/svg">\n            <g class="seat" transform="scale(1)">\n                <path class="bd" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" d="M127.05,89.33H12.38V13.83A9.67,9.67,0,0,1,22,4.17,455.22,455.22,0,0,1,69.72,1.5a436.21,436.21,0,0,1,47.71,2.67,9.67,9.67,0,0,1,9.63,9.66Z"></path>\n                <path class="bd" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" d="M12.38,89.33H127.05a0,0,0,0,1,0,0v36.26a7.59,7.59,0,0,1-7.59,7.59H20a7.59,7.59,0,0,1-7.59-7.59V89.33A0,0,0,0,1,12.38,89.33Z"></path><path stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.armrestColor}" class="bc" d="M13.84,131.7H3.08A3.09,3.09,0,0,1,0,128.61V33a3.09,3.09,0,0,1,3.08-3.08H13.84A3.09,3.09,0,0,1,16.93,33v95.64A3.09,3.09,0,0,1,13.84,131.7ZM140,128.61V33a3.09,3.09,0,0,0-3.08-3.08H126.57A3.09,3.09,0,0,0,123.49,33v95.64a3.09,3.09,0,0,0,3.08,3.08h10.34A3.09,3.09,0,0,0,140,128.61Z"></path>\n                <path class="bd" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" d="M118.59,146.5H20.86c-3.83,0-7-3.93-7-8.77v-10.2c0-4.84,3.12-8.77,7-8.77l.27,0A272.65,272.65,0,0,0,69.72,123a293.15,293.15,0,0,0,48.61-4.24l.25,0c3.83,0,7,3.93,7,8.77v10.2C125.54,142.57,122.42,146.5,118.59,146.5Z"></path><path stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" class="cf" d="M94.24,140.35H45.19a4.13,4.13,0,0,1-4.13-4.14V122a4.15,4.15,0,0,1,.11-.93l3.65-7a4.13,4.13,0,0,1,4-3.21H90.1a4.13,4.13,0,0,1,4,3.09L98.24,121a4.15,4.15,0,0,1,.13,1v14.2A4.13,4.13,0,0,1,94.24,140.35Z"></path>\n            </g>\n        </svg>`,_type4:e=>`<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">\n        <g class="seat" transform="scale(1.2)">\n            <path class="bd" fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M89.24,20c-.34-7.62-6.46-6.61-9.52-10.33S78.71.5,70.55.5H29.75c-8.16,0-6.12,5.42-9.18,9.15S11.4,12.37,11.06,20s0,13.74,0,13.74H89.24S89.58,27.61,89.24,20Z">\n            </path><path class="bd" fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M85,72.8H16.81a6.89,6.89,0,0,1-6.88-6.86V37.14a6.89,6.89,0,0,1,6.88-6.86,326.72,326.72,0,0,1,34.08-1.9A313.07,313.07,0,0,1,85,30.27a6.89,6.89,0,0,1,6.88,6.86v28.8A6.89,6.89,0,0,1,85,72.8Z"></path>\n            <rect class="bd" fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" x="9.93" y="71.69" width="81.91" height="60.75" rx="7.59" ry="7.59"></rect>\n            <path class="bc" stroke="${e.strokeColor}" fill="${e.armrestColor}" stroke-width="${e.strokeWidth}" d="M9,142.15H3.08A3.09,3.09,0,0,1,0,139.07V84.52a3.09,3.09,0,0,1,3.08-3.08H9a3.09,3.09,0,0,1,3.08,3.08v54.55A3.09,3.09,0,0,1,9,142.15Zm91-3.08V84.52a3.09,3.09,0,0,0-3.08-3.08H91.29a3.09,3.09,0,0,0-3.08,3.08v54.55a3.09,3.09,0,0,0,3.08,3.08h5.63A3.09,3.09,0,0,0,100,139.07Z"></path>\n            <path class="bd" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" \n            fill="${e.fillColor}" d="M84.71,145.5H14.9c-2.74,0-5-2.8-5-6.23V132c0-3.44,2.23-6.23,5-6.23l.19,0a195.67,195.67,0,0,0,34.71,3,210.38,210.38,0,0,0,34.72-3l.18,0c2.74,0,5,2.8,5,6.23v7.25C89.67,142.7,87.44,145.5,84.71,145.5Z"></path>\n            <path class="cf" fill="white" stroke="white" d="M67.32,141.13h-35a2.94,2.94,0,0,1-2.95-2.94V128.06a2.93,2.93,0,0,1,.08-.66L32,116.12a3,3,0,0,1,2.87-2.28H64.35a3,3,0,0,1,2.85,2.2l3,11.31a2.93,2.93,0,0,1,.1.74v10.09A2.94,2.94,0,0,1,67.32,141.13Z"></path>\n        </g>\n    </svg>`,_default:e=>`<svg version="1.1" baseProfile="full" viewBox="0 -3 110 100" xmlns="http://www.w3.org/2000/svg">\n        <g class="seat" transform="scale(2)"><rect fill="${e.armrestColor}" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n        <rect fill="${e.armrestColor}" x="49.02" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" /><path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M44.94,1.07C40.15.71,33.1,0,26.87,0,21.37,0,13.66.47,9.35.93A4.41,4.41,0,0,0,5.41,5.31V33H49V5.47A4.41,4.41,0,0,0,44.94,1.07Z" />\n        <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M47.56,37.58h-40a2.85,2.85,0,0,1-2.85-2.85V31.43a2.85,2.85,0,0,1,2.85-2.85h.11A139.86,139.86,0,0,0,27.56,30a150.41,150.41,0,0,0,19.9-1.38h.1a2.85,2.85,0,0,1,2.85,2.85v3.31A2.85,2.85,0,0,1,47.56,37.58Z" />\n        <rect fill="rgb(255, 255, 255)" x="19.25" y="28.88" width="15.92" height="5.47" rx="2.02" ry="2.02" />\n      </g></svg>`},$={getTemplate(e,t){return"1"===e?this._type1(t):"2"===e?this._type2(t):"3"===e?this._type3(t):this._default(t)},_type1:e=>`<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">\n            <g class="seat" transform="scale(1)"><path class="bd" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" d="M127.05,89.33H12.38V13.83A9.67,9.67,0,0,1,22,4.17,455.22,455.22,0,0,1,69.72,1.5a436.21,436.21,0,0,1,47.71,2.67,9.67,9.67,0,0,1,9.63,9.66Z"></path>\n            <path class="bd" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" d="M12.38,89.33H127.05a0,0,0,0,1,0,0v36.26a7.59,7.59,0,0,1-7.59,7.59H20a7.59,7.59,0,0,1-7.59-7.59V89.33A0,0,0,0,1,12.38,89.33Z"></path><path stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.armrestColor}" class="bc" d="M13.84,131.7H3.08A3.09,3.09,0,0,1,0,128.61V33a3.09,3.09,0,0,1,3.08-3.08H13.84A3.09,3.09,0,0,1,16.93,33v95.64A3.09,3.09,0,0,1,13.84,131.7ZM140,128.61V33a3.09,3.09,0,0,0-3.08-3.08H126.57A3.09,3.09,0,0,0,123.49,33v95.64a3.09,3.09,0,0,0,3.08,3.08h10.34A3.09,3.09,0,0,0,140,128.61Z"></path>\n            <path class="bd" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" d="M118.59,146.5H20.86c-3.83,0-7-3.93-7-8.77v-10.2c0-4.84,3.12-8.77,7-8.77l.27,0A272.65,272.65,0,0,0,69.72,123a293.15,293.15,0,0,0,48.61-4.24l.25,0c3.83,0,7,3.93,7,8.77v10.2C125.54,142.57,122.42,146.5,118.59,146.5Z"></path>\n            <path stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" class="cf" d="M94.24,140.35H45.19a4.13,4.13,0,0,1-4.13-4.14V122a4.15,4.15,0,0,1,.11-.93l3.65-7a4.13,4.13,0,0,1,4-3.21H90.1a4.13,4.13,0,0,1,4,3.09L98.24,121a4.15,4.15,0,0,1,.13,1v14.2A4.13,4.13,0,0,1,94.24,140.35Z"></path>\n            </g>\n        </svg>`,_type2:e=>`<svg version="1.1" baseProfile="full" viewBox="0 -3 110 100" xmlns="http://www.w3.org/2000/svg">\n      <g class="seat" transform="scale(2)">\n      <rect fill="${e.armrestColor}" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n      <rect fill="${e.armrestColor}" x="49.02" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n      <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M44.94,1.07C40.15.71,33.1,0,26.87,0,21.37,0,13.66.47,9.35.93A4.41,4.41,0,0,0,5.41,5.31V33H49V5.47A4.41,4.41,0,0,0,44.94,1.07Z" />\n      <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M47.56,37.58h-40a2.85,2.85,0,0,1-2.85-2.85V31.43a2.85,2.85,0,0,1,2.85-2.85h.11A139.86,139.86,0,0,0,27.56,30a150.41,150.41,0,0,0,19.9-1.38h.1a2.85,2.85,0,0,1,2.85,2.85v3.31A2.85,2.85,0,0,1,47.56,37.58Z" />\n      <rect fill="rgb(255, 255, 255)" x="19.25" y="28.88" width="15.92" height="5.47" rx="2.02" ry="2.02" /></g></svg>`,_type3:e=>`<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">\n      <g class="seat" transform="scale(2)"><rect fill="{$style.armrestColor}" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n      <rect fill="${e.armrestColor}" x="49.02" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n      <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M44.94,1.07C40.15.71,33.1,0,26.87,0,21.37,0,13.66.47,9.35.93A4.41,4.41,0,0,0,5.41,5.31V33H49V5.47A4.41,4.41,0,0,0,44.94,1.07Z" />\n      <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M47.56,37.58h-40a2.85,2.85,0,0,1-2.85-2.85V31.43a2.85,2.85,0,0,1,2.85-2.85h.11A139.86,139.86,0,0,0,27.56,30a150.41,150.41,0,0,0,19.9-1.38h.1a2.85,2.85,0,0,1,2.85,2.85v3.31A2.85,2.85,0,0,1,47.56,37.58Z" />\n      <rect fill="rgb(255, 255, 255)" x="19.25" y="28.88" width="15.92" height="5.47" rx="2.02" ry="2.02" /></g></svg>`,_default:e=>`<svg version="1.1" baseProfile="full" viewBox="0 0 150 220" xmlns="http://www.w3.org/2000/svg">\n      <g class="seat" transform="scale(1.2)">\n      <path class="bd" fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M89.24,20c-.34-7.62-6.46-6.61-9.52-10.33S78.71.5,70.55.5H29.75c-8.16,0-6.12,5.42-9.18,9.15S11.4,12.37,11.06,20s0,13.74,0,13.74H89.24S89.58,27.61,89.24,20Z"></path>\n      <path class="bd" fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M85,72.8H16.81a6.89,6.89,0,0,1-6.88-6.86V37.14a6.89,6.89,0,0,1,6.88-6.86,326.72,326.72,0,0,1,34.08-1.9A313.07,313.07,0,0,1,85,30.27a6.89,6.89,0,0,1,6.88,6.86v28.8A6.89,6.89,0,0,1,85,72.8Z"></path>\n      <rect class="bd" fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" x="9.93" y="71.69" width="81.91" height="60.75" rx="7.59" ry="7.59"></rect>\n      <path class="bc" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.armrestColor}" d="M9,142.15H3.08A3.09,3.09,0,0,1,0,139.07V84.52a3.09,3.09,0,0,1,3.08-3.08H9a3.09,3.09,0,0,1,3.08,3.08v54.55A3.09,3.09,0,0,1,9,142.15Zm91-3.08V84.52a3.09,3.09,0,0,0-3.08-3.08H91.29a3.09,3.09,0,0,0-3.08,3.08v54.55a3.09,3.09,0,0,0,3.08,3.08h5.63A3.09,3.09,0,0,0,100,139.07Z"></path>\n      <path class="bd" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" fill="${e.fillColor}" d="M84.71,145.5H14.9c-2.74,0-5-2.8-5-6.23V132c0-3.44,2.23-6.23,5-6.23l.19,0a195.67,195.67,0,0,0,34.71,3,210.38,210.38,0,0,0,34.72-3l.18,0c2.74,0,5,2.8,5,6.23v7.25C89.67,142.7,87.44,145.5,84.71,145.5Z"></path>\n      <path class="cf" fill="white" stroke="white" d="M67.32,141.13h-35a2.94,2.94,0,0,1-2.95-2.94V128.06a2.93,2.93,0,0,1,.08-.66L32,116.12a3,3,0,0,1,2.87-2.28H64.35a3,3,0,0,1,2.85,2.2l3,11.31a2.93,2.93,0,0,1,.1.74v10.09A2.94,2.94,0,0,1,67.32,141.13Z"></path>\n      </g></svg>`},S={getTemplate(e,t){return this._default(t)},_default:e=>`<svg version="1.1" baseProfile="full" viewBox="0 -3 110 110" width="86" height="110" xmlns="http://www.w3.org/2000/svg">\n        <g class="seat" transform="scale(2)">\n        <rect fill="${e.armrestColor}" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n        <rect fill="${e.armrestColor}" x="49.02" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n        <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M44.94,1.07C40.15.71,33.1,0,26.87,0,21.37,0,13.66.47,9.35.93A4.41,4.41,0,0,0,5.41,5.31V33H49V5.47A4.41,4.41,0,0,0,44.94,1.07Z" />\n        <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M47.56,37.58h-40a2.85,2.85,0,0,1-2.85-2.85V31.43a2.85,2.85,0,0,1,2.85-2.85h.11A139.86,139.86,0,0,0,27.56,30a150.41,150.41,0,0,0,19.9-1.38h.1a2.85,2.85,0,0,1,2.85,2.85v3.31A2.85,2.85,0,0,1,47.56,37.58Z" />\n        <rect fill="rgb(255, 255, 255)" x="19.25" y="28.88" width="15.92" height="5.47" rx="2.02" ry="2.02" />\n        </g></svg>`},_={getTemplate(e,t){return this._default(t)},_default:e=>`<svg version="1.1" baseProfile="full" viewBox="0 -3 110 100" width="110" height="100" xmlns="http://www.w3.org/2000/svg">\n        <g class="seat" transform="scale(2)"><rect fill="${e.armrestColor}" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n        <rect fill="${e.armrestColor}" x="49.02" y="4.3" width="5.36" height="32.29" rx="1.97" ry="1.97" />\n        <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M44.94,1.07C40.15.71,33.1,0,26.87,0,21.37,0,13.66.47,9.35.93A4.41,4.41,0,0,0,5.41,5.31V33H49V5.47A4.41,4.41,0,0,0,44.94,1.07Z" />\n        <path fill="${e.fillColor}" stroke="${e.strokeColor}" stroke-width="${e.strokeWidth}" d="M47.56,37.58h-40a2.85,2.85,0,0,1-2.85-2.85V31.43a2.85,2.85,0,0,1,2.85-2.85h.11A139.86,139.86,0,0,0,27.56,30a150.41,150.41,0,0,0,19.9-1.38h.1a2.85,2.85,0,0,1,2.85,2.85v3.31A2.85,2.85,0,0,1,47.56,37.58Z" />\n        <rect fill="rgb(255, 255, 255)" x="19.25" y="28.88" width="15.92" height="5.47" rx="2.02" ry="2.02" />\n        </g></svg>`};function j(e,t){void 0===t&&(t={});var s=t.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===s&&a.firstChild?a.insertBefore(r,a.firstChild):a.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}j(".jets-seat{align-items:center;box-sizing:border-box;display:flex;float:left;justify-content:center;position:relative}.jets-seat-pillow{background-color:#fff;bottom:0;height:4px;left:calc(50% - 6px);position:absolute;width:12px}.jets-unavailable{cursor:not-allowed;position:relative}.jets-available,.jets-selected{cursor:pointer;position:relative}.jets-selected{color:#fff}.jets-aisle,.jets-empty,.jets-index{pointer-events:none;transform:rotate(0)!important}.jets-seat-r-nw{transform:scale(.8) rotate(-20deg)}.jets-seat-r-ne{transform:scale(.8) rotate(20deg)}.jets-seat-r-s{transform:rotate(180deg)}.jets-seat-r-se{transform:scale(.8) rotate(160deg)}.jets-seat-r-sw{transform:scale(.8) rotate(-160deg)}svg{height:100%;width:100%}.jets-seat-passenger{align-items:center;border-radius:50%;display:flex;font-size:36px;justify-content:center;position:absolute}.jets-seat-svg{height:100%;width:100%}");const A=({data:a})=>{const{onSeatClick:r,params:l}=t(y),{letter:i,type:o,status:n,size:c,passenger:d,color:h,rotation:p,seatType:f,topOffset:m,leftOffset:u}=a,{index:w,aisle:b}=g,v=["jets-seat",`jets-${o}`,`jets-${n}`,`jets-seat-r-${p} `],C=s(),$=()=>o===w||o===b?i:d?d.abbr||"P":"",S={width:c.width,height:c.height,top:m,left:u},_={strokeColor:h,armrestColor:"rgb(185,186,186)",fillColor:"available"===n?k:"#ccc",strokeWidth:1},j={width:.8*c.width,height:.8*c.width,left:c.width/2-.4*c.width,top:c.height/2-.4*c.width,backgroundColor:d?.passengerColor||"#1157ce"},A={transform:`rotate(0deg) scale(${l.antiScale})`};return e.createElement(e.Fragment,null,e.createElement("div",{ref:C,onClick:e=>r(a,C,e),style:S,className:v.join(" ")},f&&o!==w?e.createElement(e.Fragment,null,e.createElement("div",{className:"jets-seat-svg",dangerouslySetInnerHTML:{__html:x.getTemplateBySeatType(f,_)}}),d&&e.createElement("div",{style:j,className:"jets-seat-passenger"},$())):e.createElement("div",{style:A},$())))};j(".jets-btn{-webkit-font-smoothing:antialiased;background-color:#3854f5;border:1px solid #ccc;border-radius:2px;color:#fff;cursor:pointer;display:inline-block;font-family:inherit;font-size:14px;font-weight:600;height:40px;line-height:1.5;padding:9.5px 18px;text-align:center;text-decoration:none;vertical-align:middle}.jets-btn:disabled{background-color:#ccc;color:#000;cursor:not-allowed}");const E=({content:t,onClick:s,className:a,disabled:r,active:l,...o})=>e.createElement("button",i({},o,{className:a,onClick:s,disabled:r}),t);E.defaultProps={content:"Btn",className:"jets-btn",disabled:!1,active:!1,onClick:()=>{}};j(".jets-tooltip{background:#fff;border-radius:2px;box-shadow:0 0 0 1px #c0cad5,0 0 4px 0 rgb(0 0 0/8%),0 8px 8px 0 rgb(0 0 0/8%),0 16px 16px 0 rgb(0 0 0/8%);box-sizing:border-box;font-size:12px;max-width:100%;outline:0;position:absolute;z-index:200}.jets-tooltip--content{padding:16px}.jets-tooltip--header{display:flex;font-size:15px;font-weight:700;justify-content:space-between;margin-bottom:8px;width:100%}.jets-tooltip--features>ul{list-style:none;margin:0;padding:0;width:100%}.jets-tooltip--feature img{height:8px;width:8px}.jets-tooltip--feature>span{display:block;margin-right:5px}.jets-tooltip--features>ul>li{align-items:center;color:#4f6f8f;display:flex;font-size:13px;font-weight:500;font-weight:700;line-height:1.4;margin-bottom:.6rem;width:100%}.jets-tooltip--btns-block{display:flex;width:100%}.jets-tooltip--btn{-webkit-font-smoothing:antialiased;border-radius:2px;border-style:solid;border-width:0;cursor:pointer;display:inline-block;font-family:inherit;font-size:14px;font-weight:600;line-height:1.5;padding:9.5px 18px;text-align:center;text-decoration:none;vertical-align:middle;width:50%}.jets-cancel-btn{background-color:#edf0f3;color:#001833}.jets-select-btn{background-color:#007aff;color:#fff}");const T=({data:s})=>{const{onTooltipClose:a,onSeatSelect:r,isSelectAvailable:l,onSeatUnselect:i}=t(y),{number:o,classType:n,top:c,left:d,features:h,id:p,price:g,passenger:f,nextPassanger:m,passengerTypes:w,lang:b,rowName:v,antiScale:k,transformOrigin:x}=s,C={width:220,transformOrigin:x,transform:`scale(${k})`,top:c,left:d};return e.createElement("div",{style:C,className:"jets-tooltip"},e.createElement("div",{className:"jets-tooltip--body"},e.createElement("div",{className:"jets-tooltip--content"},e.createElement("div",{className:"jets-tooltip--header"},e.createElement("div",{className:"jets-tooltip--header-title"},v||n," ",o),e.createElement("div",{className:"jets-tooltip--header-price"},g)),e.createElement("div",{className:"jets-tooltip--features"},e.createElement("ul",null,h.map((({title:t,icon:s,value:a})=>e.createElement("li",{className:"jets-tooltip--feature",key:t},e.createElement("span",null,s?e.createElement("img",{src:require(`./assets/img/${s}`)}):a),e.createElement("div",null,t))))))),e.createElement("div",{className:"jets-tooltip--btns-block"},e.createElement(E,{onClick:a,content:u[b].cancel,className:"jets-btn jets-tooltip--btn jets-cancel-btn"}),f?e.createElement(E,{onClick:()=>i(s),content:u[b].unselect,className:"jets-btn jets-tooltip--btn jets-select-btn"}):e.createElement(E,{disabled:!l||m?.passengerType&&w?.length&&!w?.includes(m?.passengerType),onClick:()=>r(s),content:u[b].select,className:"jets-btn jets-tooltip--btn jets-select-btn"}))))};j(".jets-row{position:absolute}");const P=({seats:s,top:a})=>{const{activeTooltip:r}=t(y);return e.createElement("div",{className:"jets-row",style:{top:a}},!!s.find((e=>e?.id===r?.id))&&e.createElement(T,{data:r}),s?.map((t=>e.createElement(A,{key:t.id,data:t}))))};j(".jets-deck{align-items:center;display:flex;flex-direction:column;height:100%;margin:40px 0;position:relative;width:100%}.jets-deck--title{font-size:18px;font-weight:700}");const H=({rows:s,number:a,lang:r})=>{const{params:l}=t(y),i={height:l?.decksHeight?.length?l.decksHeight[a-1]:0},o={transform:`scale(${l.antiScale})`};return e.createElement("div",{className:"jets-deck",style:i},a&&e.createElement("div",{className:"jets-deck--title",style:o},u[r].deck,": ",a),s.map((t=>e.createElement(P,{key:t.id,seats:t.seats,top:t.topOffset}))))};class W extends o{constructor(){super(),l(this,"getPlaneFeatures",(async e=>{const t=await this._auth.getToken(),s=this.getRequestOptions(t);return await this.postData("flight/features/plane",e,s)})),this._auth=new d}}class M{constructor(){l(this,"getSeatMapParams",((e,t,s)=>{const{size:a,classCode:r}=e,l=this._calculateSeatMapInnerWidth(a,r)||s.width;return{...this._calculateSeatMapScale(l,s.width),innerWidth:l,decksHeight:this._calculateDecksHeight(t)}})),l(this,"_calculateSeatMapScale",((e,t)=>({scale:t/e||1,antiScale:e/t||1}))),l(this,"_calculateSeatMapInnerWidth",((e,t)=>e*b[t]?.width)),l(this,"_calculateDecksHeight",(e=>e?.map((({rows:e})=>{if(!e.length)return 0;const t=e.at(-1),{topOffset:s,classCode:a,seats:r}=t,l=this._calculateRowMaxSeatTopOffset(r);return s+b[a].height+100+150+l||0})))),l(this,"_calculateRowMaxSeatTopOffset",(e=>e?.reduce(((e,{topOffset:t})=>(t>e&&(e=t),e)),0)))}}class N{constructor(){l(this,"_calculator",null),l(this,"prepareData",((e,t)=>{if(!e)return[];const{cabin:s,seatDetails:a}=e,r=a?.decks,l=this._getBiggestRowInfo(r),i=this._calculator.getSeatMapParams(l,r,t);return{content:r?.map((({rows:e})=>{const a={config:t,seatsNumber:l.size};return this._getPreparedRows(e,s,a)}))||[],params:i}})),l(this,"_getPreparedRows",((e,t,s)=>{if(!e?.length)return[];const a=this._getBiggestDeckRow(e),r=e.map((e=>this._prepareRow(e,t,s))),l=this._prepareRow(a,t,s);return[this._prepareIndexRow(l),...r]})),l(this,"_prepareRow",((e,t,s)=>{const{number:a,topOffset:r}=e,l=h.generateId();return{seats:this._getPreparedSeats(e,t,s),id:l,number:a,topOffset:r+100+150}})),l(this,"_getPreparedSeats",((e,t,s)=>{const{number:a,seatScheme:r,seats:l,classCode:i}=e;if(!l?.length)return[];let o=0;return r.split("").reduce(((r,n)=>{const{seat:c,aisle:d,empty:p}=f;let g=this._prepareSeat(l[o],e,t,s.config);return n===d&&(g=this._prepareAisle(a)),n===p&&(g=this._prepareEmpty()),n===c&&o++,g.size=this._calculateSeatSize(i),g.id=h.generateId(),r.push(g),r}),[])})),l(this,"_prepareIndexRow",(e=>{const{index:t,aisle:s,empty:a}=g,r=e.seats.map((e=>(e.letter=e.type===s?"":e.letter,e.type=e.type===s?a:t,e.status=p.disabled,e.topOffset=100,e.number="",e)));return{...e,number:"",seats:r,topOffset:0}})),l(this,"_prepareSeat",((e,t,s,a)=>{const{number:r,classCode:l,name:i,seatType:o}=t,n=this._prepareSeatFeatures(e,s,a.lang),c=m[l.toLowerCase()]||"",d=r+e?.letter||"",h=g.seat,f=p.available,u=`${l}-${o}`;return{...e,features:n,status:f,type:h,number:d,classType:c,classCode:l,rowName:i,seatType:u}})),l(this,"_prepareAisle",(e=>({letter:e,type:g.aisle,status:p.disabled}))),l(this,"_prepareEmpty",(()=>({letter:"",status:p.disabled,type:g.empty}))),l(this,"_calculateSeatSize",(e=>e&&b[e]?b[e]:v)),l(this,"_getBiggestDeckRow",(e=>[...e].sort(((e,t)=>t.seats.length-e.seats.length))[0])),l(this,"_getBiggestRowInfo",(e=>{let t,s=0;return e?.forEach((({rows:e})=>{const a=this._getBiggestDeckRow(e),r=a?.seatScheme?.length;r>s&&(s=r,t=a.classCode||"E")})),{size:s,classCode:t}})),l(this,"_prepareSeatFeatures",((e,t,s)=>{const{pitch:a,width:r,recline:l}=t,i={...e?.features,pitch:a,width:r,recline:l};return Object.entries(i).map((([e,t])=>{const a=u[s][e]||e,r="wifi_enabled"===e||"wifiEnabled"===e;let l=this._getFeatureIcon(t);return r&&(l=this._getFeatureIcon("wifi")),{title:a,icon:l,value:t}}))})),l(this,"_getFeatureIcon",(e=>{let t="";return"+"===e&&(t="plus.svg"),"-"===e&&(t="minus.svg"),"wifi"===e&&(t="wifi.svg"),t})),this._calculator=new M}}class B{constructor(){l(this,"getSeatMapData",(async(e,t,s,a)=>{const{width:r,lang:l,units:i}=a,o={flights:[e],featuresList:w,lang:l,units:i},n=await this._api.getPlaneFeatures(o),c=s?.find((e=>e.seat?.seatLabel));let{content:d,params:h}=this._preparer.prepareData(n[0],a);return t&&(d=this.setAvailabilityHandler(d,t)),s&&c&&(d=this.setPassengersHandler(d,s)),{content:d,params:h}})),l(this,"selectSeatHandler",((e,t,s)=>{const a=this.getNextPassenger(s),r=s.map((e=>{if(a.id===e.id){const s={price:t.price,seatLabel:t.number};e.seat=s}return e}));return{data:this.setPassengersHandler(e,r),passengers:r}})),l(this,"unselectSeatHandler",((e,t,s)=>{const a=s.map((e=>(t.passenger?.id===e.id&&(e.seat=null),e)));return{data:this.setPassengersHandler(e,a),passengers:a}})),l(this,"setAvailabilityHandler",((e,t)=>{const{selected:s,available:a,unavailable:r}=p,l=t?.find((e=>"*"===e.label));return e.map((e=>e.map((e=>{const i=e.seats.map((e=>{const i=t.find((t=>t.label===e.number));if(i){const{price:t,currency:r}=i;e.status=e.status===s?s:a,e.price=`${r} ${t||0}`||"",e.passengerTypes=i.onlyForPassengerType||l?.onlyForPassengerType||["ADT","CHD","INF"]}else e.type===g.seat&&(e.status=l?a:r,e.price=`${l?.currency} ${l?.price||0}`||"",e.passenger=null,e.passengerTypes=l?.onlyForPassengerType||["ADT","CHD","INF"]);return e}));return{...e,seats:i}}))))})),l(this,"setPassengersHandler",((e,t)=>{const{selected:s,available:a,unavailable:r}=p;return e.map((e=>e.map((e=>{const l=e.seats.map((e=>{const l=t.find((t=>e.number&&t?.seat?.seatLabel===e.number));return l&&e.status===a&&(e.status=s,e.price=l.seat?.price||e.price,e.passenger=l),l&&e.status===r&&(l.seat=null),l||e.status!==s||(e.status=a,e.passenger=null),e}));return{...e,seats:l}}))))})),l(this,"calculateTooltipData",((e,t,s,a)=>{const{offsetTop:r,offsetLeft:l}=t,{width:i}=s.getBoundingClientRect(),o=i*a,n=220*a,c=l+n>o,d=l-n<0,h=r+e.size.height/2,p=c?d?o-o/2-110:l-220+e.size.width/2:l+e.size.width/2,g=c?d?"center":"top right":"top left";return{...e,top:h,left:p,transformOrigin:g,antiScale:a}})),l(this,"getNextPassenger",(e=>e?.find((e=>!e.seat?.seatLabel)))),l(this,"addAbbrToPassengers",(e=>e?.map(((e,t)=>(e.abbr=this._getPassengerAbbr(e,t+1),e))))),l(this,"_getPassengerAbbr",((e,t)=>{const{passengerLabel:s}=e;if(!s)return`P${t}`;const a=s?.split(" ");return a.length>1?a.slice(0,2).map((e=>e[0])).join(""):s.substring(0,2).toUpperCase()})),l(this,"findPassengerBySeatNumber",((e,t)=>e.find((e=>e.seat?.seatLabel===t)))),this._api=new W,this._preparer=new N}}j(".jets-no-data{align-items:center;display:flex;font-size:18px;font-weight:700;height:100%;height:100vh;justify-content:center;width:100%}");const V=()=>{const{params:s}=t(y),a={transform:`scale(${s?.antiScale})`};return e.createElement("div",{style:a,className:"jets-no-data"},"Seat map is not found for the flight")};j('.jets-not-init{align-items:center;display:flex;font-size:18px;font-weight:700;height:100%;height:100vh;justify-content:center;width:100%}.jets-not-init--spinner{height:50px;width:50px}.lds-roller{display:inline-block;height:80px;position:relative;width:80px}.lds-roller div{animation:lds-roller 1.2s cubic-bezier(.5,0,.5,1) infinite;transform-origin:40px 40px}.lds-roller div:after{background:#000;border-radius:50%;content:" ";display:block;height:7px;margin:-4px 0 0 -4px;position:absolute;width:7px}.lds-roller div:first-child{animation-delay:-36ms}.lds-roller div:first-child:after{left:63px;top:63px}.lds-roller div:nth-child(2){animation-delay:-72ms}.lds-roller div:nth-child(2):after{left:56px;top:68px}.lds-roller div:nth-child(3){animation-delay:-.108s}.lds-roller div:nth-child(3):after{left:48px;top:71px}.lds-roller div:nth-child(4){animation-delay:-.144s}.lds-roller div:nth-child(4):after{left:40px;top:72px}.lds-roller div:nth-child(5){animation-delay:-.18s}.lds-roller div:nth-child(5):after{left:32px;top:71px}.lds-roller div:nth-child(6){animation-delay:-.216s}.lds-roller div:nth-child(6):after{left:24px;top:68px}.lds-roller div:nth-child(7){animation-delay:-.252s}.lds-roller div:nth-child(7):after{left:17px;top:63px}.lds-roller div:nth-child(8){animation-delay:-.288s}.lds-roller div:nth-child(8):after{left:12px;top:56px}@keyframes lds-roller{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}');const O=()=>e.createElement("div",{className:"jets-not-init"},e.createElement("div",{className:"lds-roller jets-not-init--spinner"},e.createElement("div",null),e.createElement("div",null),e.createElement("div",null),e.createElement("div",null),e.createElement("div",null),e.createElement("div",null),e.createElement("div",null),e.createElement("div",null)));j('@import url("https://fonts.googleapis.com/css2?family=Montserrat:wght@400");.jets-seat-map{font-family:Montserrat,sans-serif;position:relative;width:100%}');const Z=({flight:t,availability:l,passengers:i,config:o,onSeatMapInited:n,onSeatSelected:c,onSeatUnselected:d})=>{const h={...Z.defaultProps.config,...o},[f,m]=a([]),[u,w]=a(!1),[b,v]=a([]),[k,x]=a(null),[C,$]=a(!1),[S,_]=a(null),j=s(),A=new B;r((()=>{let e=!0;return t?.id&&A.getSeatMapData(t,l,i,h).then((t=>{e&&(_(t.params),m(t.content),w(!0),n())})),()=>{e=!1}}),[t]),r((()=>{const e=A.setAvailabilityHandler(f,l);E(),m(e),x(null)}),[l]),r((()=>{E(),x(null)}),[i]);const E=()=>{i=A.addAbbrToPassengers(i);const e=A.setPassengersHandler(f,i||[]);m(e),v(i)},T={zoom:S?.scale,MozTransform:`scale(${S?.scale})`,transformOrigin:"top left",width:S?.innerWidth},P={onSeatClick:(e,t,s)=>{if(e.type!==g.seat||e.status!==p.available&&e.status!==p.selected)return;const a=A.getNextPassenger(b),r=A.calculateTooltipData(e,t.current,j.current,S?.antiScale);$(!!a),x({...r,nextPassanger:a,lang:h.lang})},onTooltipClose:()=>{x(null)},onSeatSelect:e=>{const{data:t,passengers:s}=A.selectSeatHandler(f,e,b);m(t),v(s),x(null),c(s)},onSeatUnselect:e=>{const{data:t,passengers:s}=A.unselectSeatHandler(f,e,b);m(t),v(s),x(null),d(s)},isSelectAvailable:C,params:S,activeTooltip:k};return e.createElement(y.Provider,{value:P},e.createElement("div",{ref:j,className:"jets-seat-map",style:{width:h.width}},e.createElement("div",{style:T},f?.length?f?.map(((t,s)=>e.createElement(H,{rows:t,lang:h.lang,number:f.length>1&&t.length?s+1:null,key:s}))):u?e.createElement(V,null):e.createElement(O,null))))};Z.defaultProps={config:{width:350,lang:"EN",units:"metric"},onSeatMapInited:()=>{console.log("JetsSeatMap initialized!")},onSeatSelected:e=>{console.log("Passenger boarded: ",e)},onSeatUnselected:e=>{console.log("Passenger unboarded: ",e)}};export{Z as JetsSeatMap};
